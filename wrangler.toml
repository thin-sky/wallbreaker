name = "wallbreaker"
main = "dist/_worker.js"
compatibility_date = "2024-01-01"
compatibility_flags = ["nodejs_compat"]

# Cloudflare Pages integration
pages_build_output_dir = "dist"

# D1 Database (add your database_id after creating the database)
# Run: wrangler d1 create wallbreaker-db
[[d1_databases]]
binding = "DB"
database_name = "wallbreaker-db"
database_id = "YOUR_DATABASE_ID" # Replace with actual ID after creation

# R2 Storage (add after creating the bucket)
# Run: wrangler r2 bucket create wallbreaker-backups
[[r2_buckets]]
binding = "BACKUPS"
bucket_name = "wallbreaker-backups"

# Cron Triggers
[triggers]
crons = [
  "0 2 * * 0",   # Weekly backup (Sundays at 2am UTC)
  "0 3 * * *",   # Daily reconciliation (3am UTC)
]

# Environment-specific configurations
[env.staging]
name = "wallbreaker-staging"
vars = { ENVIRONMENT = "staging" }

# Uncomment and configure after creating staging resources
# [[env.staging.d1_databases]]
# binding = "DB"
# database_name = "wallbreaker-db-staging"
# database_id = "STAGING_DATABASE_ID"

# [[env.staging.r2_buckets]]
# binding = "BACKUPS"
# bucket_name = "wallbreaker-backups-staging"

[env.production]
name = "wallbreaker-production"
vars = { ENVIRONMENT = "production" }

# Uses default database and bucket configuration above
